<!-- Modern Teacher Card Component -->
<!-- Usage: {% include teacher-card.html teacher=teacher %} -->

{% assign teacher = include.teacher %}
{% assign card_class = include.class | default: "teacher-card" %}
{% assign show_details = include.show_details | default: true %}
{% assign compact = include.compact | default: false %}

<div class="{{ card_class }}{% if compact %} compact{% endif %}" 
     data-teacher-id="{{ teacher.id }}"
     data-subjects="{{ teacher.subjects | join: ',' }}"
     data-modes="{{ teacher.teaching_mode | join: ',' }}"
     data-experience="{{ teacher.experience }}"
     data-rating="{{ teacher.rating }}"
     data-price="{{ teacher.hourly_rate }}"
     data-students="{{ teacher.students_taught }}"
     data-location="{{ teacher.location }}"
     data-search="{{ teacher.name | downcase }} {{ teacher.subjects | join: ' ' | downcase }} {{ teacher.specializations | join: ' ' | downcase }}">

  <!-- Card Header with Photo and Rating -->
  <div class="teacher-card-header">
    <div class="teacher-photo-container">
      <img src="{{ teacher.photo }}" 
           alt="{{ teacher.name }}" 
           class="teacher-photo"
           loading="lazy" />
      
      <!-- Verification Badge -->
      {% if teacher.verified %}
      <div class="verification-badge">
        <i class="fas fa-check-circle"></i>
      </div>
      {% endif %}
      
      <!-- Featured Badge -->
      {% if teacher.featured %}
      <div class="featured-badge">
        <i class="fas fa-star"></i>
        <span>Featured</span>
      </div>
      {% endif %}
    </div>
    
    <!-- Rating Display -->
    <div class="rating-display">
      <div class="stars">
        {% assign rating = teacher.rating %}
        {% for i in (1..5) %}
          {% if i <= rating %}
            <i class="fas fa-star"></i>
          {% elsif i <= rating + 0.5 %}
            <i class="fas fa-star-half-alt"></i>
          {% else %}
            <i class="far fa-star"></i>
          {% endif %}
        {% endfor %}
      </div>
      <span class="rating-number">{{ teacher.rating }}</span>
      <span class="review-count">({{ teacher.students_taught }})</span>
    </div>
  </div>

  <!-- Card Content -->
  <div class="teacher-card-content">
    <!-- Teacher Info -->
    <div class="teacher-info">
      <h3 class="teacher-name">
        <a href="/teachers/{{ teacher.name | slugify }}/">{{ teacher.name }}</a>
      </h3>
      <p class="teacher-qualification">{{ teacher.qualification }}</p>
      
      <!-- Subjects Tags -->
      <div class="subjects-tags">
        {% for subject in teacher.subjects limit: 3 %}
        <span class="subject-tag" data-subject="{{ subject | slugify }}">{{ subject }}</span>
        {% endfor %}
        {% if teacher.subjects.size > 3 %}
        <span class="more-subjects">+{{ teacher.subjects.size | minus: 3 }} more</span>
        {% endif %}
      </div>
      
      <!-- Teacher Badges -->
      {% if teacher.badges.size > 0 %}
      <div class="teacher-badges">
        {% for badge in teacher.badges limit: 2 %}
        <span class="teacher-badge">{{ badge }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>
    
    {% if show_details %}
    <!-- Quick Stats -->
    <div class="teacher-stats">
      <div class="stat-item">
        <i class="fas fa-graduation-cap"></i>
        <span>{{ teacher.students_taught }} students</span>
      </div>
      <div class="stat-item">
        <i class="fas fa-clock"></i>
        <span>{{ teacher.experience }}+ years</span>
      </div>
      <div class="stat-item">
        <i class="fas fa-map-marker-alt"></i>
        <span>{{ teacher.location }}</span>
      </div>
      <div class="stat-item stat-price">
        <i class="fas fa-dollar-sign"></i>
        <span>${{ teacher.hourly_rate }}/hour</span>
      </div>
    </div>
    
    <!-- Teaching Modes -->
    <div class="teaching-modes">
      {% for mode in teacher.teaching_mode %}
      <span class="mode-tag mode-{{ mode | downcase }}">
        {% if mode == "Online" %}
          <i class="fas fa-video"></i>
        {% elsif mode == "Offline" %}
          <i class="fas fa-chalkboard-teacher"></i>
        {% else %}
          <i class="fas fa-laptop-house"></i>
        {% endif %}
        {{ mode }}
      </span>
      {% endfor %}
    </div>
    
    <!-- Bio Preview -->
    <p class="teacher-bio">{{ teacher.bio | truncate: 120 }}</p>
    
    <!-- Response Time -->
    {% if teacher.contact.response_time %}
    <div class="response-time">
      <i class="fas fa-reply"></i>
      <span>Responds {{ teacher.contact.response_time }}</span>
    </div>
    {% endif %}
    {% endif %}
  </div>

  <!-- Card Actions -->
  <div class="teacher-card-actions">
    <div class="primary-actions">
      <a href="/teachers/{{ teacher.name | slugify }}/" class="btn btn-primary">
        <i class="fas fa-user"></i>
        <span>View Profile</span>
      </a>
      <button class="btn btn-secondary" onclick="contactTeacher('{{ teacher.contact.email }}', '{{ teacher.name }}')">
        <i class="fas fa-envelope"></i>
        <span>Contact</span>
      </button>
    </div>
    
    <div class="secondary-actions">
      <button class="action-btn bookmark-btn" 
              data-teacher-id="{{ teacher.id }}" 
              title="Bookmark teacher">
        <i class="far fa-bookmark"></i>
      </button>
      <button class="action-btn share-btn" 
              data-teacher-name="{{ teacher.name }}" 
              title="Share profile">
        <i class="fas fa-share-alt"></i>
      </button>
    </div>
  </div>
</div>

<script>
// Teacher card interactions
function contactTeacher(email, name) {
    const subject = encodeURIComponent(`Inquiry about tutoring with ${name}`);
    const body = encodeURIComponent(`Hi ${name},\n\nI'm interested in learning more about your tutoring services. Could we schedule a brief conversation to discuss my learning goals?\n\nThank you!`);
    window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
}

// Initialize bookmark functionality when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    const bookmarkBtns = document.querySelectorAll('.bookmark-btn');
    
    bookmarkBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const teacherId = this.dataset.teacherId;
            const isBookmarked = this.classList.contains('bookmarked');
            
            if (isBookmarked) {
                this.classList.remove('bookmarked');
                this.querySelector('i').className = 'far fa-bookmark';
            } else {
                this.classList.add('bookmarked');
                this.querySelector('i').className = 'fas fa-bookmark';
            }
        });
    });
    
    // Share functionality
    const shareBtns = document.querySelectorAll('.share-btn');
    
    shareBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const teacherName = this.dataset.teacherName;
            const url = window.location.origin + `/teachers/${teacherName.toLowerCase().replace(/\s+/g, '-')}/`;
            
            if (navigator.share) {
                navigator.share({
                    title: `${teacherName} - Teacher Profile`,
                    text: `Check out ${teacherName}'s teaching profile`,
                    url: url
                });
            } else {
                // Fallback to copying to clipboard
                navigator.clipboard.writeText(url).then(() => {
                    showNotification('Link copied to clipboard!');
                });
            }
        });
    });
});

function showNotification(message) {
    // Simple notification - you can enhance this
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--primary-600);
        color: white;
        padding: 12px 24px;
        border-radius: 8px;
        z-index: 1000;
        font-weight: 500;
        box-shadow: var(--shadow-lg);
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>